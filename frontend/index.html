<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QaracterBlog - Visual Edition</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- Header -->
<header class="site-header">
  <div class="brand">
    <img src="qaracterLogo.webp" alt="Qaracter Logo">
    <h1>QaracterBlog</h1>
  </div>
  <nav>
    <a class="btn" href="create.html">New Post</a>
  </nav>
</header>

<main class="container">

  <!-- Sección destacada -->
  <section class="highlight">
    <h2>Featured Post</h2>
    <div id="highlight-post" class="highlight-card">Loading featured post…</div>
  </section>

  <!-- Grid de posts -->
  <section class="posts-grid" id="posts">
    <!-- JS insertará los posts aquí -->
  </section>

</main>

<!-- Footer -->
<footer class="site-footer">
  Made by the Qaracter trio
</footer>

<!-- JS -->
<script src="js/app.js"></script>
<script>
  // Cargar todos los posts
  loadPosts();

  // Colocar el primer post como destacado
  async function loadPosts() {
    const container = document.getElementById('posts');
    const highlight = document.getElementById('highlight-post');
    try {
      const res = await fetch('http://localhost:3000/posts');
      const posts = await res.json();

      if (!posts || posts.length === 0) {
        container.innerHTML = '<p class="loading">No posts yet. Be the first!</p>';
        highlight.innerHTML = '<p class="loading">No featured post yet.</p>';
        return;
      }

      // Primer post como destacado
      const first = posts[0];
      highlight.innerHTML = `
        <a href="post.html?id=${first._id}" style="color:white;text-decoration:none;">
          <h2>${first.title}</h2>
          <p class="meta">by ${first.author || 'Anonymous'} · ${new Date(first.date).toLocaleString()}</p>
          <p>${first.content.slice(0, 200)}...</p>
        </a>
      `;

      // Resto de posts en grid
      container.innerHTML = posts.slice(1).map(p => `
        <a class="card" href="post.html?id=${p._id}">
          <h2>${p.title}</h2>
          <p class="meta">by ${p.author || 'Anonymous'} · ${new Date(p.date).toLocaleString()}</p>
          <p class="excerpt">${p.content.slice(0,160)}...</p>
        </a>
      `).join('');

    } catch (err) {
      console.error(err);
      container.innerHTML = '<p class="loading">Could not load posts.</p>';
      highlight.innerHTML = '<p class="loading">Could not load featured post.</p>';
    }
  }
</script>

</body>
</html>
